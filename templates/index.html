<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
    <meta name="google-site-verification" content="1xRfZx8fEbwT18xMYj4l1UFl5jRckIrbs2uk4STqF6Y" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NexaAI â€“ Modern AI Assistant</title>

    <meta name="description"
        content="NexaAI is a modern, free, multi-model AI assistant platform. Chat with GPT-4, Claude, Gemini, DeepSeek, and more.">
    <meta name="keywords"
        content="AI, NexaAI, chatbot, GPT-4, Claude, Gemini, DeepSeek, OpenRouter, AI assistant, LLM, FOSS, chat history, free, ai tools">
    <link rel="canonical" href="https://nexa-ai.onrender.com/">
    <meta name="robots" content="index, follow">

    <!-- Green shield favicon -->
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path fill='%2319c37d' d='M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z'/></svg>">

    <!-- Main CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='Css/style.css') }}">

    <!-- Open Graph / Twitter -->
    <meta property="og:title" content="NexaAI â€“ AI Chat Assistant" />
    <meta property="og:description"
        content="A smart, free AI chat dashboard supporting GPT-4, Claude, Gemini, and more." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://nexa-ai.onrender.com/static/og-image.png" />

    <!-- Markdown + syntax highlighting -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Polyfills -->
    <script>
        if (!window.Promise) {
            document.write('<script src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js"><\/script>');
        }
        if (!window.fetch) {
            document.write('<script src="https://cdn.jsdelivr.net/npm/whatwg-fetch@3.6.2/dist/fetch.umd.js"><\/script>');
        }
    </script>

    {% if current_user.is_authenticated %}
    <script>
        // Already logged in â†’ go straight to dashboard
        window.location.href = "{{ url_for('dashboard') }}";
    </script>
    {% endif %}
</head>

<body class="ds-body">
    <!-- Nav -->
    <nav class="top-nav">
        <div class="nav-left">
            <div class="logo-container">
                <svg class="logo-icon" viewBox="0 0 24 24" width="24" height="24">
                    <path fill="currentColor" d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z" />
                </svg>
                <span class="logo-text">NexaAI</span>
            </div>
        </div>
        <div class="nav-right">
            <button class="nav-button secondary" onclick="location.href='{{ url_for('login') }}'">
                <span>L</span><span class="nav-full-text">og in</span>
            </button>
            <button class="nav-button primary" onclick="location.href='{{ url_for('signup') }}'">
                <span>S</span><span class="nav-full-text">ign up</span>
            </button>
            <button class="nav-button icon-only" type="button" onclick="openTermsModal()" title="Help">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10" />
                    <path d="M12 8a2 2 0 0 1 2 2c0 1-1 1.5-1.5 1.8-.4.3-.5.5-.5 1.2" />
                    <circle cx="12" cy="16" r="0.8" fill="currentColor" stroke="none" />
                </svg>
            </button>
        </div>
    </nav>

    <!-- Main -->
    <div class="landing-shell">
        <main class="landing-main">
            <div class="main-container">
                <div class="center-content">

                    <!-- Analysis Bar - NEW -->
                    <div id="analysis-bar" class="analysis-bar" style="display:none;">
                        <span id="analysis-text">Analyzingâ€¦</span>
                        <div class="analysis-dot"></div>
                    </div>

                    <div class="welcome-section" id="welcome-section">
                        <h1 class="main-heading">What can I help with?</h1>
                        <p style="color: var(--text-secondary); margin-top: 0.5rem; font-size: 0.9rem;">
                            ğŸ’¡ Try asking: "Explain quantum computing" or "Write a Python function"
                        </p>
                        <p style="color: var(--text-tertiary); margin-top: 0.25rem; font-size: 0.8rem;">
                            ğŸ§  Demo has temporary memory - I remember our conversation until you refresh
                        </p>
                    </div>

                    <div id="messages-container"></div>
                    <div style="height: 120px;"></div>
                </div>
            </div>

            <!-- Input -->
            <div class="input-wrapper fixed-input">
                <div class="input-box">
                    <div class="input-inner">
                        <textarea id="chat-input" placeholder="Ask anything..." rows="1"></textarea>
                        <button class="send-button" id="send-btn" title="Send message">
                            <!-- send icon -->
                            <span id="send-icon">
                                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                                    <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
                                </svg>
                            </span>
                            <!-- stop icon -->
                            <span id="stop-icon" style="display:none;">
                                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                                    <rect x="6" y="6" width="12" height="12" rx="2" ry="2"></rect>
                                </svg>
                            </span>
                        </button>
                    </div>
                    <div class="input-footer">
                        <span class="demo-notice">
                            ğŸ Demo Mode â€“ <span id="message-counter">10 messages left</span> Â· Temporary memory Â· Claude 3 Haiku Â·
                            <a href="javascript:void(0)" onclick="openTermsModal()"
                                style="text-decoration:underline;cursor:pointer;">Terms</a> Â·
                            <a href="{{ url_for('signup') }}" style="font-weight: 600;">Sign up free</a>
                        </span>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Terms Modal -->
    <div id="terms-modal" class="modal-overlay" style="display:none;">
        <div class="modal-container">
            <div class="modal-header">
                <h2>Terms & Policies</h2>
                <button class="modal-close" onclick="closeTermsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <h3>ğŸ”’ Privacy & Data Use</h3>
                <p>Demo mode has <strong>temporary memory</strong> - your conversation is remembered until you refresh 
                   the page. Conversations are <strong>not saved</strong> to our servers. Sign up for permanent chat history.</p>

                <h3>âš ï¸ AI Limitations</h3>
                <ul>
                    <li>AI responses may contain inaccurate or outdated information</li>
                    <li>Do not rely on AI for medical, legal, or financial advice</li>
                    <li>Always verify important information from authoritative sources</li>
                    <li>AI may occasionally produce biased or inappropriate content</li>
                </ul>

                <h3>âœ… Acceptable Use</h3>
                <ul>
                    <li>Be respectful and constructive in your queries</li>
                    <li>Do not attempt to jailbreak or manipulate the AI</li>
                    <li>Do not use for illegal activities or harmful purposes</li>
                    <li>Content moderation policies apply</li>
                </ul>

                <h3>ğŸ Demo vs Full Access</h3>
                <table style="width: 100%; border-collapse: collapse; margin-top: 0.5rem;">
                    <tr style="border-bottom: 1px solid var(--color-border);">
                        <td style="padding: 0.5rem;"><strong>Demo</strong></td>
                        <td style="padding: 0.5rem;">10 msg/hour, temporary memory, Claude 3 Haiku</td>
                    </tr>
                    <tr style="border-bottom: 1px solid var(--color-border);">
                        <td style="padding: 0.5rem;"><strong>Free Account</strong></td>
                        <td style="padding: 0.5rem;">4 AI models, permanent history, image gen</td>
                    </tr>
                    <tr>
                        <td style="padding: 0.5rem;"><strong>Pro (Free trial)</strong></td>
                        <td style="padding: 0.5rem;">All 9 models, DeepThink, Web, unlimited</td>
                    </tr>
                </table>

                <p style="margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid var(--color-border); font-size: 0.9rem;">
                    By using NexaAI, you agree to these terms. We respect your privacy and never sell your data.
                </p>
            </div>
        </div>
    </div>

    <!-- Demo Chat Script with SSE Streaming + Memory -->
    <script>
        /**
         * NexaAI Demo - Claude 3 Haiku Streaming + Temporary Memory
         * Features: SSE streaming, "Analyzing X messages", Stop button, Memory
         */

        'use strict';

        let isResponding = false;
        let currentStreamController = null;
        let messageCount = 0;
        const MAX_MESSAGES_DEMO = 10;

        // ğŸ§  TEMPORARY MEMORY
        let conversationHistory = [];
        const MAX_HISTORY_LENGTH = 10;

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // INIT
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        document.addEventListener("DOMContentLoaded", () => {
            updateMessageCounter();

            const chatInput = document.getElementById('chat-input');
            if (chatInput) {
                chatInput.addEventListener('input', function () {
                    this.style.height = 'auto';
                    this.style.height = Math.min(this.scrollHeight, 200) + 'px';
                });
                chatInput.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        handleSendClick();
                    }
                });
            }

            document.getElementById('send-btn').addEventListener('click', handleSendClick);
        });

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // COUNTER
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function updateMessageCounter() {
            const counter = document.getElementById('message-counter');
            if (!counter) return;

            const remaining = MAX_MESSAGES_DEMO - messageCount;
            counter.textContent = remaining > 0 ? `${remaining} messages left` : 'Limit reached';
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // MEMORY
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function addToMemory(role, content) {
            conversationHistory.push({ role, content, timestamp: Date.now() });
            if (conversationHistory.length > MAX_HISTORY_LENGTH) {
                conversationHistory = conversationHistory.slice(-MAX_HISTORY_LENGTH);
            }
        }

        function getContextForAPI() {
            return conversationHistory.slice(-6).map(m => ({ role: m.role, content: m.content }));
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // UI HELPERS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function showAnalysisBar(text) {
            document.getElementById('analysis-text').textContent = text;
            document.getElementById('analysis-bar').style.display = 'flex';
        }

        function hideAnalysisBar() {
            document.getElementById('analysis-bar').style.display = 'none';
        }

        function showTypingIndicator() {
            const container = document.getElementById('messages-container');
            if (document.getElementById('typing-indicator')) return;

            const typing = document.createElement('div');
            typing.id = 'typing-indicator';
            typing.className = 'message-row assistant-row';
            typing.innerHTML = `
                <div class="message assistant-message">
                    <div class="avatar">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                            <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"></path>
                        </svg>
                    </div>
                    <div class="typing-dots"><span></span><span></span><span></span></div>
                </div>
            `;
            container.appendChild(typing);
            container.scrollTop = container.scrollHeight;
        }

        function removeTypingIndicator() {
            const typing = document.getElementById('typing-indicator');
            if (typing) typing.remove();
        }

        function setInputLocked(locked) {
            const input = document.getElementById('chat-input');
            const sendIcon = document.getElementById('send-icon');
            const stopIcon = document.getElementById('stop-icon');

            input.readOnly = locked;
            sendIcon.style.display = locked ? 'none' : 'block';
            stopIcon.style.display = locked ? 'block' : 'none';
            isResponding = locked;
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // SSE STREAMING HANDLER
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        async function handleSendClick() {
            if (isResponding) {
                stopAIResponse();
                return;
            }

            const input = document.getElementById('chat-input');
            const message = input.value.trim();

            if (!message || messageCount >= MAX_MESSAGES_DEMO) return;

            // UI updates
            const welcome = document.getElementById('welcome-section');
            if (welcome) welcome.style.display = 'none';

            addMessage(message, 'user');
            addToMemory('user', message);

            input.value = '';
            input.style.height = 'auto';
            messageCount++;
            updateMessageCounter();

            showTypingIndicator();
            setInputLocked(true);

            const context = getContextForAPI();

            try {
                const controller = new AbortController();
                currentStreamController = controller;

                const res = await fetch('/demo-chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message, context }),
                    signal: controller.signal
                });

                const reader = res.body.getReader();
                const decoder = new TextDecoder();
                let buffer = '';
                let assistantBuffer = '';
                let assistantRow = null;

                while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;

                    buffer += decoder.decode(value, { stream: true });

                    let pos;
                    while ((pos = buffer.indexOf('\n\n')) >= 0) {
                        const event = buffer.slice(0, pos).trim();
                        buffer = buffer.slice(pos + 2);

                        const lines = event.split('\n');
                        let eventType = 'message';
                        let data = '';

                        for (const line of lines) {
                            if (line.startsWith('event: ')) eventType = line.slice(7).trim();
                            else if (line.startsWith('data: ')) data += line.slice(6).trim();
                        }

                        if (!data) continue;

                        if (eventType === 'meta') {
                            const meta = JSON.parse(data);
                            showAnalysisBar(`Analyzing ${meta.messages_analyzed || 1} message${meta.messages_analyzed > 1 ? 's' : ''}â€¦`);
                        } else if (eventType === 'token') {
                            const tokenData = JSON.parse(data);
                            assistantBuffer += tokenData.delta || '';

                            if (!assistantRow) {
                                removeTypingIndicator();
                                assistantRow = createAssistantRow();
                            }

                            const contentDiv = assistantRow.querySelector('.markdown-content');
                            contentDiv.innerHTML = marked.parse(assistantBuffer);
                            hljs.highlightAll();
                            document.getElementById('messages-container').scrollTop = 
                                document.getElementById('messages-container').scrollHeight;
                        } else if (eventType === 'error') {
                            const err = JSON.parse(data);
                            removeTypingIndicator();
                            hideAnalysisBar();
                            setInputLocked(false);
                            addMessage(err.error || 'Unknown error', 'error');
                            return;
                        } else if (eventType === 'done') {
                            removeTypingIndicator();
                            hideAnalysisBar();
                            setInputLocked(false);
                            if (assistantBuffer.trim()) addToMemory('assistant', assistantBuffer.trim());
                            return;
                        }
                    }
                }
            } catch (err) {
                if (err.name === 'AbortError') return;
                console.error('Stream error:', err);
                removeTypingIndicator();
                hideAnalysisBar();
                setInputLocked(false);
                addMessage('âŒ Network error. Please try again.', 'error');
            }
        }

        function createAssistantRow() {
            const container = document.getElementById('messages-container');
            const row = document.createElement('div');
            row.className = 'message-row assistant-row message-streaming';
            row.innerHTML = `
                <div class="message assistant-message">
                    <div class="avatar">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                            <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"></path>
                        </svg>
                    </div>
                    <div class="message-content">
                        <div class="model-badge">Demo Â· Claude 3 Haiku</div>
                        <div class="markdown-content"></div>
                    </div>
                </div>
            `;
            container.appendChild(row);
            return row;
        }

        function stopAIResponse() {
            if (currentStreamController) {
                currentStreamController.abort();
                currentStreamController = null;
            }
            removeTypingIndicator();
            hideAnalysisBar();
            setInputLocked(false);
            isResponding = false;
        }

        function addMessage(text, role, modelName = null) {
            const container = document.getElementById('messages-container');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message-row ${role}-row`;

            if (role === 'user') {
                messageDiv.innerHTML = `<div class="message user-message"><div class="message-content">${text}</div></div>`;
            } else if (role === 'assistant') {
                messageDiv.innerHTML = `
                    <div class="message assistant-message">
                        <div class="avatar">
                            <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                                <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"></path>
                            </svg>
                        </div>
                        <div class="message-content">
                            <div class="model-badge">${modelName || 'Claude 3 Haiku'}</div>
                            <div class="markdown-content">${marked.parse(text)}</div>
                        </div>
                    </div>
                `;
                hljs.highlightAll();
            } else {
                messageDiv.innerHTML = `<div class="message error-message"><div class="message-content">âš ï¸ ${text}</div></div>`;
            }

            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // MODALS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function openTermsModal() { document.getElementById('terms-modal').style.display = 'flex'; }
        function closeTermsModal() { document.getElementById('terms-modal').style.display = 'none'; }

        document.addEventListener('click', (e) => {
            if (e.target.id === 'terms-modal') closeTermsModal();
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeTermsModal();
        });

        // CSS for new features (inline)
        const style = document.createElement('style');
        style.textContent = `
            .analysis-bar { display: flex; align-items: center; gap: 6px; font-size: 12px; color: var(--text-secondary); padding: 6px 16px 0 16px; }
            .analysis-dot { width: 6px; height: 6px; border-radius: 999px; background: var(--color-primary); animation: analysisPulse 1.4s infinite; }
            @keyframes analysisPulse { 0%,100%{opacity:.4;transform:scale(.9)} 50%{opacity:1;transform:scale(1.1)} }
            .typing-dots { display: flex; gap: 4px; padding: 12px 16px; background: rgba(59,130,246,.1); border-radius: 12px; border: 1px solid rgba(59,130,246,.2); }
            .typing-dots span { width: 8px; height: 8px; background: var(--color-primary); border-radius: 50%; animation: typing 1.4s infinite; }
            .typing-dots span:nth-child(2) { animation-delay: .2s; }
            .typing-dots span:nth-child(3) { animation-delay: .4s; }
            @keyframes typing { 0%,60%,100%{transform:translateY(0)} 30%{transform:translateY(-10px)} }
            .message-streaming .markdown-content { overflow: hidden; }
            .model-badge { font-size: 11px; color: var(--text-secondary); margin-bottom: 4px; }
        `;
        document.head.appendChild(style);
    </script>
</body>

</html>
